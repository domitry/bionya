/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(t,e){var n=e();"undefined"!=typeof define&&define.amd&&define(n),t.Bionya=n}(this,function(){var t,e,n;return function(r){function a(t,e){return v.call(t,e)}function i(t,e){var n,r,a,i,o,s,u,l,c,p,d,h=e&&e.split("/"),f=_.map,g=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(h=h.slice(0,h.length-1),t=t.split("/"),o=t.length-1,_.nodeIdCompat&&k.test(t[o])&&(t[o]=t[o].replace(k,"")),t=h.concat(t),c=0;c<t.length;c+=1)if(d=t[c],"."===d)t.splice(c,1),c-=1;else if(".."===d){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||g)&&f){for(n=t.split("/"),c=n.length;c>0;c-=1){if(r=n.slice(0,c).join("/"),h)for(p=h.length;p>0;p-=1)if(a=f[h.slice(0,p).join("/")],a&&(a=a[r])){i=a,s=c;break}if(i)break;!u&&g&&g[r]&&(u=g[r],l=c)}!i&&u&&(i=u,s=l),i&&(n.splice(0,s,i),t=n.join("/"))}return t}function o(t,e){return function(){return h.apply(r,b.call(arguments,0).concat([t,e]))}}function s(t){return function(e){return i(e,t)}}function u(t){return function(e){x[t]=e}}function l(t){if(a(m,t)){var e=m[t];delete m[t],y[t]=!0,d.apply(r,e)}if(!a(x,t)&&!a(y,t))throw new Error("No "+t);return x[t]}function c(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function p(t){return function(){return _&&_.config&&_.config[t]||{}}}var d,h,f,g,x={},m={},_={},y={},v=Object.prototype.hasOwnProperty,b=[].slice,k=/\.js$/;f=function(t,e){var n,r=c(t),a=r[0];return t=r[1],a&&(a=i(a,e),n=l(a)),a?t=n&&n.normalize?n.normalize(t,s(e)):i(t,e):(t=i(t,e),r=c(t),a=r[0],t=r[1],a&&(n=l(a))),{f:a?a+"!"+t:t,n:t,pr:a,p:n}},g={require:function(t){return o(t)},exports:function(t){var e=x[t];return"undefined"!=typeof e?e:x[t]={}},module:function(t){return{id:t,uri:"",exports:x[t],config:p(t)}}},d=function(t,e,n,i){var s,c,p,d,h,_,v=[],b=typeof n;if(i=i||t,"undefined"===b||"function"===b){for(e=!e.length&&n.length?["require","exports","module"]:e,h=0;h<e.length;h+=1)if(d=f(e[h],i),c=d.f,"require"===c)v[h]=g.require(t);else if("exports"===c)v[h]=g.exports(t),_=!0;else if("module"===c)s=v[h]=g.module(t);else if(a(x,c)||a(m,c)||a(y,c))v[h]=l(c);else{if(!d.p)throw new Error(t+" missing "+c);d.p.load(d.n,o(i,!0),u(c),{}),v[h]=x[c]}p=n?n.apply(x[t],v):void 0,t&&(s&&s.exports!==r&&s.exports!==x[t]?x[t]=s.exports:p===r&&_||(x[t]=p))}else t&&(x[t]=n)},t=e=h=function(t,e,n,a,i){if("string"==typeof t)return g[t]?g[t](e):l(f(t,e).f);if(!t.splice){if(_=t,_.deps&&h(_.deps,_.callback),!e)return;e.splice?(t=e,e=n,n=null):t=r}return e=e||function(){},"function"==typeof n&&(n=a,a=i),a?d(r,t,e,n):setTimeout(function(){d(r,t,e,n)},4),h},h.config=function(t){return h(t)},t._defined=x,n=function(t,e,n){e.splice||(n=e,e=[]),a(x,t)||a(m,t)||(m[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("contrib/almond/almond",function(){}),n("tools",[],function(){var t={STL:Nyaplot.STL,_:Nyaplot._,uuid:Nyaplot.uuid,Manager:Nyaplot.Manager};return t}),n("components/scale",["tools"],function(t){function e(t,e){var n=Math.abs(e.x[1]-e.x[0]),r=Math.abs(e.y[1]-e.y[0]);return this.scales={},this.center={x:n/2,y:r/2},this.max_r=Math.min(n,r)/2,this}var n=t._;return e.prototype.init=function(t,e,n,r){this.inner_radius=t,this.outer_radius=e,this.inner_num=n,this.outer_num=r,this.inner_thickness=t/(n+1),this.outer_thickness=(this.max_r-e)/r},e.prototype.addGroup=function(t,e,n,r){var a=d3.scale.ordinal().domain(e).rangePoints([n,r],1);this.scales[t]=a,this.width=(r-n)/(e.length+1)},e.prototype.groups=function(){return n.keys(this.scales)},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(t){return t>=0?this.outer_thickness:this.inner_thickness},e.prototype.getCenter=function(){return this.center},e.prototype.getRange=function(t){var e,n;return t>0?(e=this.outer_radius+this.outer_thickness*(t-1),n=e+this.outer_thickness):(n=this.inner_radius,e=n-this.inner_thickness),[e,n]},e.prototype.get=function(t,e,n){var r,a;return r=t>0?this.outer_radius+this.outer_thickness*t:this.inner_radius-this.inner_thickness*t*-1,a=this.scales[e](n),{x:r*Math.sin(a),y:-r*Math.cos(a),r:r,theta:a}},e}),n("components/axis",["tools"],function(t){function e(e,n,r){var a=t._,i=t.Manager,o={width:0,height:0,margin:{top:0,bottom:0,left:0,right:0},x_label:"X",y_label:"Y",zoom:!0,zoom_range:[.5,5],rotate_x_label:0,rotate_y_label:0,pane_uuid:null,z_index:0,extra:{}},s={df_id:null,inner_radius:150,outer_radius:170,group_by:null,axis:null,chord:!1,matrix:null,inner_num:0,outer_num:1,color:["#253494"],text_color:"#fff",text_size:"1em"};arguments.length>2&&(a.extend(o,r),a.extend(s,r.extra),o.extra=s);var u=i.getData(o.extra.df_id),l=u.column(o.extra.group_by),c={},p=o.extra.chord?o.extra.matrix:[],d=d3.scale.ordinal().range(o.extra.color);a.each(l,function(t,e){var n=u.nested_column(e,o.extra.axis);if(c[t]=n,null==o.extra.matrix){p[e]=[];for(var r=0;r<l.length;r++)p[e][r]=r==e?n.length:0}});var h=d3.layout.chord().padding(.05).matrix(p),f=e.append("g").attr("transform","translate("+o.width/2+","+o.height/2+")"),g="clip"+o.pane_uuid;f.append("clipPath").attr("id",g).append("rect").attr({x:-o.width/2,y:-o.height/2,width:o.width,height:o.height}),f.attr("clip-path","url(#"+g+")").style("z-index",o.z_index);var x=o.pane_uuid+"group";f.append("g").selectAll("g").data(h.groups).enter().append("g").attr("class","group_arcs").append("path").style("fill",function(t){return d(t.index)}).style("stroke",function(t){return d(t.index)}).attr("d",d3.svg.arc().innerRadius(o.extra.inner_radius).outerRadius(o.extra.outer_radius)).attr("id",function(t,e){return x+e}),f.selectAll(".group_arcs").append("text").attr("x",6).attr("dy",15).append("textPath").attr("xlink:href",function(t,e){return"#"+x+e}).text(function(t,e){return l[e]}).attr("fill",o.extra.text_color).attr("font-size",o.extra.text_size),o.extra.chord&&f.append("g").selectAll("path").data(h.chords).enter().append("path").attr("d",d3.svg.chord().radius(o.extra.inner_radius)).style("fill","#fff"),n.init(o.extra.inner_radius,o.extra.outer_radius,o.extra.inner_num,o.extra.outer_num),f.selectAll(".group_arcs").each(function(t,e){n.addGroup(l[e],c[l[e]],t.startAngle,t.endAngle)});a.flatten(a.map(c,function(t,e){return a.map(t,function(t){return n.get(0,e,t)})}));o.zoom&&e.call(d3.behavior.zoom().scaleExtent(o.zoom_range).on("zoom",function(){var t=d3.event.translate,n=d3.event.scale;e.select(".context_child").attr("transform","translate("+t+") scale("+n+")"),f.select("g").attr("transform","translate("+t+") scale("+n+")"),f.attr("transform","translate("+n*o.width/2+","+n*o.height/2+")"),f.select("clipPath").select("rect").attr({x:-o.width*n/2,y:-o.height*n/2})}))}return e}),n("diagrams/arc",["tools"],function(t){function e(t,e,a,i){var o={range:[0,0],width:.5,color:["rgb(166,206,227)","rgb(31,120,180)","rgb(178,223,138)","rgb(51,160,44)","rgb(251,154,153)","rgb(227,26,28)","rgb(253,191,111)","rgb(255,127,0)","rgb(202,178,214)"],fill_by:null,x:null,y:null,layer:1,axis:!0};return arguments.length>3&&n.extend(o,i),this.height_scale=function(){var t=e.getHeight(o.layer);return d3.scale.linear().domain(o.range).range([0,t])}(),this.inner_radius=e.getRange(o.layer)[0],this.model=function(){var n=e.getCenter();return t.append("g").attr("transform","translate("+n.x+","+n.y+")")}(),this.scales=e,this.df=r.getData(a),this.color_scale=d3.scale.ordinal().range(o.color),this.uuid=o.uuid,this.options=o,this}var n=t._,r=t.Manager;return e.prototype.update=function(){var t=this.scales.groups(),e=this;this.options.axis&&!function(){var t=e.height_scale.ticks(5);t.reverse().pop();var n=e.model.append("g").selectAll("g").data(t).enter().append("g");n.append("circle").attr("fill","none").attr("stroke","#000").attr("r",function(t){return e.inner_radius+e.height_scale(t)}),n.append("text").attr("y",function(t){return-1*(e.inner_radius+e.height_scale(t)+4)}).text(function(t){return t})}(),n.each(t,function(t,n){var r=e.df.nested_column(n,e.options.x),a=e.df.nested_column(n,e.options.y),i=e.processData(t,r,a);e.updateModels(i)})},e.prototype.processData=function(t,e,r){var a=this;return n.map(e,function(e,n){var i=a.scales.get(a.options.layer,t,e);return i.height=a.height_scale(r[n]),i})},e.prototype.updateModels=function(t){var e=this.inner_radius,n=this.scales.getWidth()*this.options.width,r=this.color_scale;this.model.append("g").selectAll("path").data(t).enter().append("path").attr("d",d3.svg.arc().startAngle(function(t){return t.theta-n/2}).endAngle(function(t){return t.theta+n/2}).innerRadius(e).outerRadius(function(t){return e+t.height})).attr("stroke",function(t,e){return r(e)}).attr("fill",function(t,e){return r(e)})},e.prototype.getLegend=function(){},e.prototype.checkSelectedData=function(){},e}),n("diagrams/connector",["tools"],function(t){function e(t,e,a,i){var o={color:"#737373",fill_by:null,from:null,to:null,shape:"circle",stroke_width:2,size:100,shape_fill:"#fff",shape_stroke:"#3182bd",shape_stroke_width:2,arc_height:30,layer:0};arguments.length>3&&n.extend(o,i),this.model=function(){var n=e.getCenter();return t.append("g").attr("transform","translate("+n.x+","+n.y+")")}(),this.scales=e,this.df=r.getData(a),this.uuid=o.uuid,this.options=o}var n=t._,r=t.Manager;return e.prototype.update=function(){var t=this.df.column(this.options.from),e=this.df.column(this.options.to),n=this.processData(t,e);this.updateModels(n)},e.prototype.processData=function(t,e){var r=this.scales,a=this.options.layer,i=this.options.arc_height;return n.map(n.zip(t,e),function(t){var e=n.map(t,function(t){var e=t.split(/(.+)\.(.+)/),n=e[1],i=e[2],o=r.get(a,n,i);return{x:o.x,y:o.y}}),o=function(){var t=n.map(["x","y"],function(t){return(e[0][t]+e[1][t])/2}),r=Math.sqrt(t[0]*t[0]+t[1]*t[1]),a=n.map(t,function(t){return t/r});return{x:a[0]*(r-i),y:a[1]*(r-i)}}();return[e[0],o,e[1]]})},e.prototype.updateModels=function(t){var e=(this.scales,this.layer,this.options),r=this.model.selectAll("g").data(t).enter().append("g");r.append("path").attr("d",d3.svg.line().tension(.2).x(function(t){return t.x}).y(function(t){return t.y}).interpolate("cardinal")).attr("fill","none").attr("stroke",e.color).attr("stroke-width",e.stroke_width),r.append("g").selectAll("path").data(n.filter(n.flatten(t),function(t,e){return e%3!=1})).enter().append("path").attr("d",d3.svg.symbol().type(e.shape).size(e.size)).attr("fill",e.shape_fill).attr("stroke",e.shape_stroke).attr("stroke-width",e.shape_stroke_width).attr("transform",function(t){return"translate("+t.x+","+t.y+")"})},e.prototype.getLegend=function(){},e.prototype.checkSelectedData=function(){},e}),n("diagrams/labels",["tools"],function(t){function e(t,e,a,i){var o={color:"#000",fill_by:null,x:null,text:null,stroke_width:4,text_size:"1em",layer:1};arguments.length>3&&n.extend(o,i),this.model=function(){var n=e.getCenter();return t.append("g").attr("transform","translate("+n.x+","+n.y+")")}(),this.scales=e,this.df=r.getData(a),this.uuid=o.uuid,this.options=o}var n=t._,r=t.Manager;return e.prototype.update=function(){var t=this.scales.groups(),e=this;n.each(t,function(t,n){var r=e.df.nested_column(n,e.options.x),a=e.df.nested_column(n,e.options.text),i=e.processData(t,r,a);e.updateModels(i)})},e.prototype.processData=function(t,e,r){var a=this.scales,i=this.options.layer;return n.filter(n.map(n.zip(e,r),function(e){return{theta:a.get(i,t,e[0]).theta,text:e[1]}}),function(t){return null!=t.text&&t.text.length>0})},e.prototype.updateModels=function(t){var e=this.scales,n=this.options.layer,r=this.options,a=e.getRange(n)[0],i=this.model.append("g").selectAll("g").data(t).enter().append("g").attr("transform",function(t){return"rotate("+180*((t.theta-Math.PI/2)/Math.PI)+")"});i.append("text").text(function(t){return t.text}).attr("text-anchor","start").attr("dominant-baseline","middle").attr("fill",r.color).attr("x",a+10).attr("y",0).attr("font-size",r.text_size),i.append("line").attr("x1",a).attr("x2",a+5).attr("y1",0).attr("y2",0).attr("stroke","#000")},e.prototype.getLegend=function(){},e.prototype.checkSelectedData=function(){},e}),n("main",["require","exports","module","components/scale","components/axis","diagrams/arc","diagrams/connector","diagrams/labels"],function(t){var e={};return e.Nya={scale:t("components/scale"),axis:t("components/axis"),diagrams:{arc:t("diagrams/arc"),connector:t("diagrams/connector"),labels:t("diagrams/labels")}},e}),e("main")});